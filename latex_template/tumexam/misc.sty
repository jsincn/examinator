%% misc.sty
%
% This work may be distributed and/or modified under the conditions of
% the LaTeX Project Public License, either version 1.3 of this license
% or (at your option) any later version.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX version
% 2005/12/01 or later.
%
% This work has the LPPL maintenance status `maintained'.
%
% The Current Maintainer of this work is Stephan GÃ¼nther.
%
% Copyright 2016-2021 Chair of Network Architectures and Services, TUM
%
% This work consists of the files listed in manifest.txt.

\ProvidesPackage{tumexam/misc}

\RequirePackage{xstring}
\RequirePackage{tikz}

\RequirePackage{tumexam/jobname}


\newcount\tumexam@dpage
\newcommand{\clearquadpage}{%
	\cleardoublepage%
	\tumexam@dpage\c@page%
	\@ifundefined{AddToHook}{}{%
		% After cleardoublepage the page counter points to the page after the
		% cleared double pages, so substract one. In the old latex
		% version the counter is only updated when the next page
		% starts, so only do this for latex >= 2020.10.
		\advance\tumexam@dpage -1%
	}%
	\divide\tumexam@dpage 2%
	\tumexam@dpage\tumexam@dpage%
	\ifodd\tumexam@dpage%
		\null%
		\cleardoublepage%
	\fi%
}


\newcommand{\formatitemize}[1]{%
	\expandafter\def\expandafter\formatitemize@list\expandafter{#1}%
	\foreach \x in \formatitemize@list {%
		\ifx\x\@empty\else\item \x\fi%
	}%
}
\def\makecomma{,}


\newcounter{permute@listcounter}
\newcommand{\listlen}[1]{%
	\setcounter{permute@listcounter}{0}%
	\foreach \x in #1 {%
		\stepcounter{permute@listcounter}%
	}%
}
\newcounter{permute@counter}
\newcommand{\permute}[2][\relax]{%
	\ifx#1\relax%
		\pgfmathrandominteger{\permute@N}{0}{9999}%
	\else%
		\edef\permute@N{#1}%
	\fi%
	\edef\permute@tmpa{#2}%
	\listlen{\permute@tmpa}%
	\edef\permute@output{}%
	\ifx\@empty\permute@tmpa\else%
	\foreach \n in {1,...,\thepermute@listcounter} {%
		\setcounter{permute@counter}{0}%
		\pgfmathparse{int(mod(\permute@N,\thepermute@listcounter-\n+1))}%
		\edef\permute@pgfmathresult{\pgfmathresult}%
		\edef\permute@tmpb{}%
		\foreach \x in \permute@tmpa {%
			\ifnum\permute@pgfmathresult=\thepermute@counter%
				\ifnum\n=1%
					\xdef\permute@output{\permute@output\x}%
				\else%
					\xdef\permute@output{\permute@output,\x}%
				\fi%
			\else%
				\ifx\@empty\x\else%
					\xdef\permute@tmpb{\permute@tmpb\x,}%
				\fi%
			\fi%
			\stepcounter{permute@counter}%
		}%
		\xdef\permute@tmpa{\permute@tmpb}%
	}%
	\fi%
	\@ifnextchar[{\permute@save}{\permute@output}%
}
\def\permute@save[#1]{%
	\edef#1{\permute@output}%
}

\def\stripzero#1{\expandafter\stripzerohelp#1}
\def\stripzerohelp#1{\ifx 0#1\expandafter\stripzerohelp\else#1\fi}

\newcommand{\tumrandseed}[1]{%
	\IfInteger{\tumexam@jobname@extra}{%
		\edef\tumrandseed@tmp{\expandafter\stripzero{\tumexam@jobname@extra}}%
		\edef#1{\tumrandseed@tmp}%
	}{%
		\edef#1{42}%
	}%
}

\tumrandseed{\tumexam@seed}
\pgfmathsetseed{\tumexam@seed}
\pgfmathgeneratepseudorandomnumber % discard first random value


% Some usefull macros
\newcommand{\Capitalize}[1]{%
	\uppercase{\StrLeft{#1}{1}}\StrGobbleLeft{#1}{1}%
}


\newcommand*{\opn}[1]{\operatorname{#1}}

\newcommand{\pr}[1]{\opn{Pr}\left[#1\right]}
\newcommand{\expect}[1]{\opn{E}\left[#1\right]}
\newcommand{\var}[1]{\opn{Var}\left[#1\right]}

\newcommand{\pd@part}[2]{#1\hskip-.25ex#2\hskip.15ex}%
\def\pd{\@ifstar{\pd@part{\hskip.3ex\partial}}{\pd@part{\hskip.2ex\opn{d}}}}

\newcommand*{\fixme}[1]{\textcolor{red}{\textbf{[#1]}}}

\endinput

